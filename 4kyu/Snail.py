def snail(snail_map):
    if snail_map == [[]]:
        return [[]]

    result = []
    size = len(snail_map) ** 2
    p = len(snail_map) * 4

    def rec(y, x, count, delta, perimeter):
        if count == size:
            result.append(snail_map[y][x])
            return result

        if count == perimeter - 4:
            delta += 1
            perimeter += (len(snail_map) - 2 * delta) * 4 - 4

        result.append(snail_map[y][x])
        if y == 0 + delta and x < len(snail_map) - 1 - delta:
            rec(y, x + 1, count + 1, delta, perimeter)
        elif x == len(snail_map) - 1 - delta and y < len(snail_map) - 1 - delta:
            rec(y + 1, x, count + 1, delta, perimeter)
        elif y == len(snail_map) - 1 - delta and x > 0 + delta:
            rec(y, x - 1, count + 1, delta, perimeter)
        elif x == 0 + delta and y >= 0 + delta:
            rec(y - 1, x, count + 1, delta, perimeter)

    rec(0, 0, 1, 0, p)

    return result


array0 = [[]]
array = [[1, 2, 3],
         [8, 9, 4],
         [7, 6, 5]]
array1 = [[1, 2, 3, 4, 5],
          [6, 7, 8, 9, 10],
          [11, 12, 13, 14, 15],
          [16, 17, 18, 19, 20],
          [21, 22, 23, 24, 25]]
array3 = [[1, 2, 3, 4, 5, 6, 7],
          [6, 7, 8, 9, 10, 11, 12],
          [11, 12, 13, 14, 15, 12, 13],
          [16, 17, 18, 19, 20, 13, 14],
          [21, 22, 23, 24, 25, 14, 15],
          [21, 22, 23, 24, 25, 14, 16],
          [21, 22, 23, 24, 25, 14, 16]]
array2 = [[639, 587, 271, 321, 986, 6, 106, 197, 974, 363, 145, 179, 454, 939],
          [784, 297, 898, 601, 558, 24, 218, 445, 228, 238, 403, 628, 73, 621],
          [552, 753, 746, 621, 646, 734, 346, 510, 728, 539, 978, 79, 82, 283],
          [924, 406, 430, 441, 362, 492, 942, 253, 463, 187, 385, 65, 641, 357],
          [44, 311, 228, 983, 815, 403, 753, 10, 322, 272, 880, 242, 375, 382],
          [779, 553, 889, 87, 305, 5, 804, 119, 34, 34, 833, 583, 981, 95],
          [774, 132, 280, 584, 299, 730, 388, 610, 544, 231, 988, 529, 902, 872],
          [326, 724, 4, 552, 758, 554, 89, 708, 970, 108, 225, 771, 726, 685],
          [166, 178, 133, 824, 897, 374, 588, 842, 488, 196, 262, 383, 112, 745],
          [298, 417, 277, 275, 100, 614, 555, 699, 56, 964, 764, 222, 167, 156],
          [118, 885, 562, 573, 278, 870, 420, 649, 581, 343, 274, 868, 259, 122],
          [258, 837, 398, 192, 279, 755, 954, 970, 219, 142, 789, 588, 787, 37],
          [302, 888, 895, 409, 475, 555, 18, 490, 255, 738, 525, 635, 147, 671],
          [627, 966, 565, 273, 741, 326, 660, 199, 687, 928, 993, 903, 8, 688]]
# [639, 587, 271, 321, 986, 6, 106, 197, 974, 363, 145, 179, 454, 939, 621, 283, 357, 382, 95, 872, 685, 745, 156, 122, 37, 671, 688, 8, 903, 993, 928, 687, 199, 660, 326, 741, 273, 565, 966, 627, 302, 258, 118, 298, 166, 326, 774, 779, 44, 924, 552, 784, 297, 898, 601, 558, 24, 218, 445, 228, 238, 403, 628, 73, 82, 641, 375, 981, 902, 726, 112, 167, 259, 787, 147, 635, 525, 738, 255, 490, 18, 555, 475, 409, 895, 888, 837, 885, 417, 178, 724, 132, 553, 311, 406, 753, 746, 621, 646, 734, 346, 510, 728, 539, 978, 79, 65, 242, 583, 529, 771, 383, 222, 868, 588, 789, 142, 219, 970, 954, 755, 279, 192, 398, 562, 277, 133, 4, 280, 889, 228, 430, 441, 362, 492, 942, 253, 463, 187, 385, 880, 833, 988, 225, 262, 764, 274, 343, 581, 649, 420, 870, 278, 573, 275, 824, 552, 584, 87, 983, 815, 403, 753, 10, 322, 272, 34, 231, 108, 196, 964, 56, 699, 555, 614, 100, 897, 758, 299, 305, 5, 804, 119, 34, 544, 970, 488, 842, 588, 374, 554, 730, 388, 610, 708, 89]
print(snail(array2))
